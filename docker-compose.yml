services:
  backend:
    build: ./backend
    # ★修正点1: ポートマッピングを変更
    # "ホストのポート:コンテナのポート"
    ports:
      - "8000:7860" 
    volumes:
      - ./backend:/app
    # ★修正点2: ローカル開発用コマンドで上書き
    # コンテナ内は7860で動かしつつ、ホットリロード(--reload)を有効にする
    command: uvicorn main:app --host 0.0.0.0 --port 7860 --reload
    environment:
      - CHOKIDAR_USEPOLLING=true

  frontend:
    # (フロントエンドの設定は変更なしでOKですが、念のためAPI先を確認)
    build: ./frontend
    ports:
      - "5173:5173"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    command: npm run dev -- --host
    # ...他はそのまま